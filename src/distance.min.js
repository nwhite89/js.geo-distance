(function(){if(typeof Number.prototype.toRad==="undefined"){Number.prototype.toRad=function(){return this*Math.PI/180}}window.geoDistance={distances:{yards:6967410,km:6371,miles:3959,metres:6371e3,feet:20902231},distanceSort:function(e,t){e.sort(function(e,t){var n=e.distance,r=t.distance;if(n==r){return 0}return n>r?1:-1});if(t!="asc"){e.reverse()}return e},init:function(e,t,n,r,i){i=i||2;r=r||"km";var s=e,o=t.slice(0),u=this.distances[r],a=parseFloat(s.lng),f=parseFloat(s.lat);f=f.toRad();for(var l=t.length-1;l>=0;l--){var c=o[l],h=parseFloat(c.lat),p=parseFloat(c.lng),d=(f-h).toRad(),v=(a-p).toRad(),m={earthRadius:u,decimals:i,dLat:d,dLng:v,toLng:p,fromLat:f};m["toLat"]=h.toRad();o[l]["distance"]=this.retrieveDistance(m)}if(n){o=this.distanceSort(o,n)}return o},retrieveDistance:function(e){var t=e.earthRadius,n=e.decimals,r=e.dLat,i=e.dLng,s=e.toLat,o=e.toLng,u=e.fromLat,a=Math.sin(r/2)*Math.sin(r/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(s)*Math.cos(u),f=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),l=t*f,c=Math.round(l*Math.pow(10,n))/Math.pow(10,n)*1e3;return c}}})()